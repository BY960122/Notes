## 需求,取最大的经纬度,最小经纬度
```text
 polygon  (( 108.78850422 29.59756592, 108.78878269 29.59727791, 108.78900204 29.59696129, 108.78924427 29.59655121, 108.78936253 29.59638908, 108.78943119 29.59625938, 108.78944264 29.59647492, 108.78933010 29.59667137, 108.78898678 29.59720352, 108.78873882 29.59748009, 108.78850041 29.59773186, 108.78802738 29.59807137, 108.78778896 29.59823922, 108.78753910 29.59841469, 108.78662357 29.59902695, 108.78570804 29.59962777, 108.78509388 29.60006264, 108.78445681 29.60044603, 108.78384838 29.60073403, 108.78322084 29.60100298, 108.78289279 29.60110787, 108.78254184 29.60118989, 108.78182277 29.60135011, 108.78111896 29.60151605, 108.78045329 29.60166482, 108.77907427 29.60188798, 108.77835902 29.60200814, 108.77781352 29.60209016, 108.77565058 29.60217980, 108.77454050 29.60222367, 108.77348383 29.60225610, 108.77248437 29.60218553, 108.77188547 29.60203675, 108.77145822 29.60185365, 108.77108819 29.60169534, 108.77072770 29.60153512, 108.77020700 29.60131959, 108.76908738 29.60086755, 108.76797349 29.60040787, 108.76519448 29.60209969, 108.76237725 29.60375720, 108.76460504 29.60484058, 108.78710804 29.60628252, 108.78711185 29.60651905, 108.78710995 29.60670405, 108.78783665 29.60730677, 108.78846035 29.60782175, 108.78886089 29.60816317, 108.78897152 29.60904627, 108.78904972 29.60972148, 108.78907261 29.60994654, 108.78952084 29.61068660, 108.79000340 29.61147815, 108.79041920 29.61212092, 108.79081211 29.61271983, 108.79084645 29.61273891, 108.79163991 29.61265307, 108.79250775 29.61256915, 108.79341374 29.61273128, 108.79408322 29.61285335, 108.79503690 29.61181003, 108.79569493 29.61109286, 108.79586660 29.61090403, 108.79632627 29.61040240, 108.79647886 29.61023837, 108.79663717 29.61006289, 108.79778539 29.61034327, 108.79896413 29.61063319, 108.79920065 29.61068660, 108.80026495 29.61104899, 108.80123388 29.61138469, 108.80189383 29.61267406, 108.80227148 29.61341792, 108.80254042 29.61394054, 108.80253854 29.61625420, 108.80385081 29.61776483, 108.80499522 29.61860406, 108.80667369 29.61903131, 108.80870312 29.62028254, 108.81033582 29.62084712, 108.81106824 29.62182368, 108.81412001 29.62243404, 108.81740067 29.62132014, 108.81880448 29.62121333, 108.82129167 29.62000788, 108.82206410 29.61975414, 108.82257717 29.61954433, 108.82322949 29.61927349, 108.82386464 29.61901409, 108.82450932 29.61856777, 108.82517880 29.61808902, 108.82556599 29.61778003, 108.82578725 29.61760455, 108.82631177 29.61612826, 108.82664365 29.61529666, 108.82690877 29.61465007, 108.82700986 29.61386615, 108.82709378 29.61320429, 108.82701558 29.61271220, 108.82693166 29.61210757, 108.82680577 29.61165553, 108.82649869 29.61067133, 108.82623166 29.60999613, 108.82606000 29.60955935, 108.82597035 29.60933809, 108.82540769 29.60884409, 108.82485264 29.60834818, 108.82461804 29.60813455, 108.82439297 29.60775881, 108.82415455 29.60734491, 108.82392949 29.60695963, 108.82374066 29.60639314, 108.82361287 29.60601358, 108.82349461 29.60565118, 108.82415265 29.60415963, 108.82426137 29.60390214, 108.82459706 29.60328225, 108.82480305 29.60290650, 108.82495946 29.60261849, 108.82482213 29.60186700, 108.82470006 29.60117844, 108.82424039 29.60070923, 108.82412213 29.60059098, 108.82450932 29.59950379, 108.82470959 29.59894303, 108.82489270 29.59842423, 108.82504719 29.59748772, 108.82512921 29.59697655, 108.82521695 29.59648064, 108.82556409 29.59614685, 108.82596272 29.59576157, 108.82667226 29.59507492, 108.82707280 29.59468963, 108.82727117 29.59450081, 108.82746190 29.59431198, 108.82727307 29.59369209, 108.82710904 29.59314659, 108.82708806 29.59308555, 108.82582349 29.59300544, 108.82505482 29.59299972, 108.82433003 29.59300544, 108.82294720 29.59302261, 108.82197827 29.59303405, 108.82125920 29.59303787, 108.82053631 29.59279563, 108.81976574 29.59253623, 108.81886165 29.59267547, 108.81788700 29.59282424, 108.81725948 29.59254577, 108.81678455 29.59233787, 108.81622760 29.59297302, 108.81562106 29.59366729, 108.81466357 29.59392860, 108.81388919 29.59413459, 108.81237857 29.59360435, 108.81067530 29.59414604, 108.80980364 29.59442451, 108.80901781 29.59467247, 108.80780664 29.59465339, 108.80664316 29.59462669, 108.80575624 29.59429863, 108.80507913 29.59404686, 108.80426851 29.59465721, 108.80339685 29.59531906, 108.80288949 29.59455612, 108.80249658 29.59396675, 108.80254236 29.59270790, 108.80256715 29.59198310, 108.80258813 29.59147575, 108.80285898 29.59031798, 108.80300393 29.58971145, 108.80318513 29.58895614, 108.80331865 29.58775641, 108.80339494 29.58711745, 108.80345788 29.58655287, 108.80238786 29.58558012, 108.80123963 29.58453299, 108.80065408 29.58421827, 108.80011620 29.58392454, 108.79957833 29.58364225, 108.79820695 29.58421255, 108.79733338 29.58457304, 108.79684700 29.58477903, 108.79531540 29.58582236, 108.79447998 29.58638502, 108.79348625 29.58696677, 108.79328407 29.58726050, 108.79268516 29.58815695, 108.79223693 29.58883406, 108.79205574 29.58910300, 108.79148734 29.59030654, 108.79120506 29.59087493, 108.79110206 29.59113051, 108.79110015 29.59139564, 108.79108680 29.59175612, 108.79107345 29.59205367, 108.79075302 29.59265639, 108.79084266 29.59384086, 108.79073585 29.59411361, 108.79062713 29.59439017, 108.79050888 29.59467246, 108.79033531 29.59496810, 108.78975926 29.59594658, 108.78957234 29.59624985, 108.78945599 29.59622314, 108.78988517 29.59555938, 108.79014839 29.59512641, 108.79022468 29.59499480, 108.79036773 29.59473541, 108.79057945 29.59431388, 108.79066909 29.59407355, 108.79073966 29.59383132, 108.79062332 29.59374740, 108.79027809 29.59352996, 108.79016555 29.59340980, 108.78984893 29.59306266, 108.78986038 29.59268500, 108.78997291 29.59258582, 108.79027999 29.59232642, 108.79049552 29.59222915, 108.79094757 29.59202506, 108.79095901 29.59182288, 108.79097429 29.59166828, 108.79098573 29.59146229, 108.79101434 29.59106556, 108.79108682 29.59026066, 108.79125276 29.58875004, 108.79131952 29.58820644, 108.79143014 29.58765712, 108.79156557 29.58720317, 108.79168001 29.58682361, 108.79171434 29.58666339, 108.79173723 29.58643070, 108.79173341 29.58622089, 108.79168382 29.58592334, 108.79158655 29.58568683, 108.79146638 29.58545604, 108.79110017 29.58491435, 108.79067293 29.58432880, 108.79037538 29.58387866, 108.79010453 29.58339992, 108.79002252 29.58317103, 108.79001489 29.58306041, 108.79003015 29.58297076, 108.79006639 29.58288684, 108.79016176 29.58281054, 108.79048791 29.58265033, 108.79081979 29.58251109, 108.79142251 29.58229556, 108.79196992 29.58211627, 108.79251733 29.58197512, 108.79322687 29.58181872, 108.79398981 29.58171572, 108.79538027 29.58152117, 108.79623858 29.58138766, 108.79709688 29.58125414, 108.79767863 29.58115878, 108.79824130 29.58104243, 108.79875247 29.58082118, 108.79923121 29.58051600, 108.79960505 29.58019938, 108.79993502 29.57978358, 108.80003421 29.57947077, 108.79999034 29.57914461, 108.79989306 29.57888903, 108.79975955 29.57864489, 108.79945056 29.57819094, 108.79906718 29.57775606, 108.79867427 29.57735933, 108.79822032 29.57698168, 108.79801241 29.57683290, 108.79733530 29.57647814, 108.79703585 29.57628168, 108.79670779 29.57600130, 108.79638163 29.57565988, 108.79601923 29.57520975, 108.79571406 29.57468141, 108.79555384 29.57420839, 108.79547945 29.57383455, 108.79546610 29.57337106, 108.79549852 29.57304109, 108.79553858 29.57280458, 108.79564348 29.57234300, 108.79574839 29.57193292, 108.79572931 29.57131875, 108.79602114 29.57088960, 108.79611269 29.57054627, 108.79627482 29.56995118, 108.79651705 29.56906045, 108.79662577 29.56864846, 108.79673258 29.56824029, 108.79690615 29.56757081, 108.79702631 29.56665337, 108.79709688 29.56622040, 108.79717127 29.56580460, 108.79730669 29.56507027, 108.79739634 29.56459152, 108.79745356 29.56433594, 108.79746500 29.56420814, 108.79746500 29.56407844, 108.79733149 29.56394493, 108.79745356 29.56383621, 108.79753748 29.56371605, 108.79756037 29.56362068, 108.79761568 29.56347763, 108.79765574 29.56331550, 108.79772250 29.56297218, 108.79779688 29.56262886, 108.79795519 29.56195556, 108.79805819 29.56149971, 108.79815356 29.56105148, 108.79835383 29.56015312, 108.79850642 29.55955421, 108.79867427 29.55893813, 108.79887645 29.55830680, 108.79912631 29.55770026, 108.79929797 29.55742370, 108.79954402 29.55716620, 108.79991595 29.55663596, 108.80005519 29.55644141, 108.80021731 29.55625258, 108.80041758 29.55609999, 108.80060641 29.55600844, 108.80080287 29.55592452, 108.80100505 29.55587493, 108.80143039 29.55580245, 108.80179851 29.55577193, 108.80216472 29.55576048, 108.80287425 29.55576048, 108.80370014 29.55579482, 108.80448787 29.55581771, 108.80507915 29.55580435, 108.80558079 29.55575667, 108.80584591 29.55569563, 108.80611293 29.55561934, 108.80663555 29.55545340, 108.80728786 29.55515585, 108.80757778 29.55500517, 108.80786198 29.55484496, 108.80817478 29.55463133, 108.80842846 29.55441389, 108.80856579 29.55428038, 108.80867070 29.55413923, 108.80876034 29.55391989, 108.80882901 29.55368910, 108.80892056 29.55343923, 108.80904835 29.55314550, 108.80934209 29.55253324, 108.80951375 29.55219183, 108.80970830 29.55180463, 108.81012219 29.55095014, 108.81031674 29.55045804, 108.81053418 29.54999456, 108.81082028 29.54945287, 108.81105870 29.54903516, 108.81132573 29.54862127, 108.81146306 29.54842099, 108.81160993 29.54822644, 108.81171674 29.54809674, 108.81181401 29.54799947, 108.81192655 29.54792508, 108.81228322 29.54778394, 108.81264562 29.54765424, 108.81328267 29.54741963, 108.81411237 29.54713735, 108.81494016 29.54753598, 108.81581373 29.54796323, 108.81677694 29.54842481, 108.81744642 29.54875096, 108.81812162 29.54908094, 108.81910963 29.54955015, 108.82006522 29.54999646, 108.82102843 29.55044088, 108.82212325 29.55095014, 108.82323333 29.55146703, 108.82425185 29.55193433, 108.82525130 29.55240354, 108.82611724 29.55280599, 108.82698699 29.55321035, 108.82898781 29.55413733, 108.83000442 29.55460463, 108.83103249 29.55508719, 108.83278344 29.55590163, 108.83367226 29.55630789, 108.83456681 29.55672560, 108.83548615 29.55715285, 108.83639596 29.55757437, 108.83735536 29.55802069, 108.83826707 29.55843840, 108.83926652 29.55904494, 108.84002565 29.56000625, 108.84044717 29.56053268, 108.84075807 29.56092940, 108.84140657 29.56270706, 108.84151529 29.56300079, 108.84178613 29.56373893, 108.84191774 29.56410133, 108.84207224 29.56452095, 108.84258341 29.56592476, 108.84289049 29.56676781, 108.84310411 29.56735146, 108.84331392 29.56792748, 108.84345507 29.56831467, 108.84422182 29.56977570, 108.84460329 29.57050812, 108.84484553 29.57097352, 108.84503626 29.57134354, 108.84553408 29.57228578, 108.84580683 29.57281602, 108.84606242 29.57330239, 108.84650301 29.57413972, 108.84681391 29.57473481, 108.84713626 29.57536615, 108.84748721 29.57603181, 108.84777903 29.57658304, 108.84800219 29.57701791, 108.84852481 29.57800211, 108.84881472 29.57855715, 108.84907222 29.57905497, 108.84932208 29.57945932, 108.84958339 29.57987703, 108.85025668 29.58096613, 108.85059047 29.58150210, 108.85092807 29.58204760, 108.85130954 29.58266749, 108.85156512 29.58307185, 108.85165668 29.58323397, 108.85234333 29.58412852, 108.85279155 29.58472171, 108.85323787 29.58531298, 108.85362888 29.58582797, 108.85423923 29.58662715, 108.85464550 29.58716121, 108.85503841 29.58768001, 108.85559536 29.58841243, 108.85598637 29.58893505, 108.85636593 29.58942333, 108.85679699 29.58999744, 108.85727192 29.59062877, 108.85827900 29.59185329, 108.85879590 29.59247128, 108.85916401 29.59290424, 108.85951878 29.59331814, 108.86035420 29.59430615, 108.86078526 29.59480778, 108.86110951 29.59518544, 108.86137845 29.59550778, 108.86178281 29.59597699, 108.86212422 29.59638707, 108.86255147 29.59661214, 108.86318853 29.59694211, 108.86405256 29.59739224, 108.86455228 29.59774701, 108.86513402 29.59809987, 108.86557844 29.59836309, 108.86622312 29.59859197, 108.86686971 29.59880750, 108.86698415 29.59876172, 108.86709669 29.59872167, 108.86691930 29.59882085, 108.86673048 29.59892575, 108.86565473 29.59952848, 108.86489942 29.59995191, 108.86444356 29.60020749, 108.86414029 29.60037343, 108.86354520 29.60055654, 108.86306264 29.60070150, 108.86256864 29.60078924, 108.86207845 29.60087507, 108.86195447 29.60090368, 108.86161878 29.60131948, 108.86130406 29.60171239, 108.86141469 29.60221593, 108.86150815 29.60265081, 108.86145284 29.60323446, 108.86141087 29.60359686, 108.86112477 29.60421865, 108.86100652 29.60447233, 108.86106373 29.60528868, 108.86107327 29.60548514, 108.86158635 29.60567969, 108.86210515 29.60587424, 108.86318090 29.60604590, 108.86408498 29.60610312, 108.86437490 29.60611456, 108.86478307 29.60608977, 108.86549070 29.60603827, 108.86652830 29.60579031, 108.86721685 29.60558432, 108.86763647 29.60545462, 108.86876562 29.60537069, 108.86984137 29.60557287, 108.87097624 29.60558050, 108.87198142 29.60527723, 108.87248877 29.60511320, 108.87309722 29.60490339, 108.87425498 29.60492819, 108.87463454 29.60579031, 108.87373427 29.60636824, 108.87270049 29.60670966, 108.87163046 29.60700720, 108.87084654 29.60768431, 108.87066344 29.60867423, 108.87086562 29.60937232, 108.87096289 29.60966224, 108.87134245 29.61014289, 108.87158087 29.61044997, 108.87244299 29.61114997, 108.87322310 29.61183280, 108.87371711 29.61245269, 108.87461547 29.61360473, 108.87507705 29.61416168, 108.87553481 29.61470718, 108.87635497 29.61569519, 108.87674216 29.61620064, 108.87711028 29.61670608, 108.87820510 29.61835976, 108.87875633 29.61918183, 108.87932472 29.62000008, 108.87967376 29.62059517, 108.87986068 29.62093087, 108.88002472 29.62131425, 108.88035469 29.62216111, 108.88059311 29.62280389, 108.88075714 29.62318727, 108.88099747 29.62375184, 108.88123398 29.62423059, 108.88154488 29.62485048, 108.88210182 29.62574693, 108.88262444 29.62654039, 108.88291436 29.62697145, 108.88319664 29.62739107, 108.88368111 29.62814256, 108.88388329 29.62859651, 108.88406639 29.62904093, 108.88413887 29.62952539, 108.88420182 29.63000605, 108.88417893 29.63049624, 108.88414460 29.63101885, 108.88388138 29.63151858, 108.88368111 29.63189623, 108.88298683 29.63265154, 108.88267212 29.63355181, 108.88270645 29.63455889, 108.88271218 29.63555072, 108.88226204 29.63646815, 108.88119392 29.63665126, 108.88019256 29.63626979, 108.87907676 29.63657115, 108.87825851 29.63726161, 108.87752418 29.63800166, 108.87674026 29.63877223, 108.87576369 29.63933681, 108.87478522 29.63981746, 108.87422637 29.64002536, 108.87375716 29.64019130, 108.87282447 29.64073299, 108.87231330 29.64143299, 108.87221602 29.64156841, 108.87192801 29.64221119, 108.87181166 29.64246868, 108.87170866 29.64272808, 108.87150458 29.64326595, 108.87128714 29.64382481, 108.87109259 29.64430928, 108.87023810 29.64488530, 108.86915854 29.64497113, 108.86801413 29.64488339, 108.86687544 29.64465451, 108.86582639 29.64432072, 108.86484029 29.64392208, 108.86419370 29.64358257, 108.86385800 29.64341282, 108.86327626 29.64302944, 108.86293294 29.64280437, 108.86257817 29.64250492, 108.86213948 29.64214634, 108.86163403 29.64166759, 108.86104657 29.64109920, 108.86049344 29.64055751, 108.86003186 29.64009975, 108.85957791 29.63964199, 108.85927655 29.63935016, 108.85895611 29.63906787, 108.85835339 29.63856815, 108.85733105 29.63815807, 108.85627056 29.63848995, 108.85585285 29.63942264, 108.85561634 29.64038776, 108.85479809 29.64052318, 108.85391880 29.63997005, 108.85287738 29.63950084, 108.85185123 29.63922428, 108.85074496 29.63929676, 108.85022807 29.63964580, 108.84988284 29.63988422, 108.84949565 29.64053844, 108.84934306 29.64079403, 108.84918284 29.64113163, 108.84891963 29.64170002, 108.84867549 29.64224934, 108.84848857 29.64267658, 108.84830737 29.64311146, 108.84813761 29.64350819, 108.84797930 29.64391064, 108.84768557 29.64473843, 108.84750628 29.64536213, 108.84744143 29.64558529, 108.84740710 29.64575314, 108.84724879 29.64662480, 108.84705042 29.64750981, 108.84675097 29.64799046, 108.84652781 29.64835668, 108.84605669 29.64868093, 108.84561037 29.64899755, 108.84501909 29.64981389, 108.84483599 29.65066648, 108.84471773 29.65150381, 108.84466624 29.65196538, 108.84462618 29.65238882, 108.84456705 29.65324712, 108.84453844 29.65379453, 108.84452509 29.65424467, 108.84450030 29.65478254, 108.84444307 29.65524984, 108.84438967 29.65573050, 108.84424662 29.65621878, 108.84411310 29.65667463, 108.84374117 29.65737463, 108.84337687 29.65805174, 108.84306024 29.65870406, 108.84276270 29.65934111, 108.84243273 29.65977408, 108.84215807 29.66012694, 108.84137415 29.66077163, 108.84025262 29.66096236, 108.83936189 29.66043593, 108.83901094 29.65952231, 108.83890222 29.65913512, 108.83876107 29.65858962, 108.83854173 29.65846182, 108.83819841 29.65828253, 108.83782266 29.65808608, 108.83731721 29.65780951, 108.83678887 29.65752150, 108.83607552 29.65671850, 108.83536217 29.65596319, 108.83433983 29.65549971, 108.83280442 29.65499998, 108.83200714 29.65472914, 108.83121559 29.65446211, 108.83042595 29.65426374, 108.83008835 29.65417982, 108.82969734 29.65410162, 108.82884094 29.65394331, 108.82819435 29.65382887, 108.82754203 29.65372396, 108.82675430 29.65361334, 108.82611533 29.65364576, 108.82555457 29.65367246, 108.82499953 29.65392233, 108.82449981 29.65413786, 108.82364341 29.65474821, 108.82334395 29.65519453, 108.82308265 29.65557409, 108.82310363 29.65607191, 108.82311717 29.65655089, 108.82324305 29.65702963, 108.82336703 29.65756560, 108.82354060 29.65794326, 108.82378283 29.65849448, 108.82408038 29.65890838, 108.82430163 29.65921737, 108.82475368 29.65977622, 108.82564059 29.66090156, 108.82589427 29.66134406, 108.82614413 29.66177894, 108.82639590 29.66232063, 108.82658283 29.66269828, 108.82716648 29.66361000, 108.82786647 29.66431381, 108.82856456 29.66508438, 108.82885067 29.66554405, 108.82912342 29.66599228, 108.82922642 29.66630890, 108.82934658 29.66670944, 108.82954876 29.66741516, 108.82968227 29.66787865, 108.83004658 29.66884377, 108.83033840 29.66923478, 108.83064167 29.66964104, 108.83119862 29.67052415, 108.83090679 29.67090943, 108.83058826 29.67132333, 108.83001415 29.67148927, 108.82950870 29.67163232, 108.82906620 29.67179444, 108.82830135 29.67209390, 108.82748309 29.67246774, 108.82646457 29.67297891, 108.82543269 29.67348817, 108.82438556 29.67378190, 108.82346621 29.67321351, 108.82351580 29.67281106, 108.82358828 29.67228463, 108.82379809 29.67135957, 108.82379428 29.67081788, 108.82379046 29.67032387, 108.82342997 29.66948845, 108.82306185 29.66862442, 108.82240000 29.66686012, 108.82213679 29.66624405, 108.82186404 29.66565659, 108.82136240 29.66467621, 108.82120409 29.66424324, 108.82104197 29.66377212, 108.82098475 29.66331245, 108.82092562 29.66278030, 108.82096949 29.66230346, 108.82101527 29.66181518, 108.82109728 29.66082717, 108.82108584 29.65984488, 108.82092562 29.65888739, 108.82061854 29.65796424, 108.82017794 29.65705252, 108.81929674 29.65637923, 108.81876650 29.65656043, 108.81822100 29.65674735, 108.81769266 29.65678740, 108.81713953 29.65681220, 108.81710329 29.65586996, 108.81720629 29.65489912, 108.81715860 29.65443945, 108.81709566 29.65387869, 108.81614961 29.65327597, 108.81505289 29.65307951, 108.81402673 29.65269422, 108.81370630 29.65227651, 108.81340493 29.65188741, 108.81306161 29.65102720, 108.81278886 29.65011739, 108.81205834 29.64807843, 108.81178178 29.64711903, 108.81171884 29.64615391, 108.81189813 29.64520405, 108.81230630 29.64426945, 108.81279649 29.64342068, 108.81298722 29.64293240, 108.81314935 29.64252613, 108.81314553 29.64207600, 108.81314553 29.64154575, 108.81286325 29.64062450, 108.81238641 29.63966511, 108.81186379 29.63885639, 108.81167878 29.63787029, 108.81234445 29.63711307, 108.81317987 29.63648555, 108.81419649 29.63609264, 108.81530466 29.63627193, 108.81577386 29.63642261, 108.81632318 29.63661334, 108.81647577 29.63644168, 108.81691255 29.63590953, 108.81688394 29.63578555, 108.81668749 29.63495395, 108.81582536 29.63433978, 108.81526842 29.63428828, 108.81464662 29.63423297, 108.81372728 29.63407847, 108.81303491 29.63401934, 108.81230058 29.63396785, 108.81125726 29.63402125, 108.81027688 29.63417384, 108.80923928 29.63439319, 108.80855263 29.63453242, 108.80794800 29.63465449, 108.80680168 29.63493678, 108.80632866 29.63513896, 108.80581368 29.63536021, 108.80546844 29.63576076, 108.80511614 29.63617647, 108.80476519 29.63627566, 108.80440470 29.63637675, 108.80397936 29.63649691, 108.80355402 29.63661516, 108.80307909 29.63598955, 108.80262514 29.63538874, 108.80275484 29.63443697, 108.80279299 29.63419664, 108.80282541 29.63396013, 108.80289980 29.63348711, 108.80228754 29.63178766, 108.80196831 29.63093512, 108.80181452 29.63049829, 108.80175348 29.63030565, 108.80167528 29.63011682, 108.80122705 29.63015306, 108.80077882 29.63019311, 108.79988428 29.63027513, 108.79960008 29.63025415, 108.79930635 29.63022745, 108.79872270 29.63017595, 108.79755540 29.63006532, 108.79679176 29.62948744, 108.79604790 29.62891523, 108.79531998 29.62868821, 108.79459138 29.62847077, 108.79386086 29.62825143, 108.79313607 29.62803399, 108.79260964 29.62816369, 108.79209084 29.62830102, 108.79107231 29.62855470, 108.79007477 29.62851655, 108.78958076 29.62848985, 108.78933281 29.62847840, 108.78908867 29.62846696, 108.78856605 29.62829530, 108.78804153 29.62812936, 108.78700503 29.62778989, 108.78489931 29.62678281, 108.78283937 29.62682859, 108.78141348 29.62637650, 108.78069250 29.62621056, 108.77995436 29.62604653, 108.77914946 29.62567650, 108.77839415 29.62532364, 108.77727835 29.62524735, 108.77697889 29.62523018, 108.77667753 29.62521302, 108.77650396 29.62519776, 108.77638570 29.62519204, 108.77625219 29.62518059, 108.77610342 29.62516915, 108.77562086 29.62487923, 108.77511541 29.62459313, 108.77464620 29.62430512, 108.77417127 29.62402474, 108.77315465 29.62406861, 108.77290288 29.62407433, 108.77265302 29.62408577, 108.77214185 29.62410103, 108.77194348 29.62398659, 108.77172414 29.62386071, 108.77130261 29.62361466, 108.77089635 29.62336479, 108.77048245 29.62311684, 108.77026501 29.62322747, 108.77004758 29.62334763, 108.76995602 29.62338577, 108.76986447 29.62342583, 108.76969662 29.62350022, 108.76951924 29.62347542, 108.76924458 29.62329994, 108.76898137 29.62312256, 108.76872769 29.62295281, 108.76848545 29.62279259, 108.76828328 29.62284599, 108.76809063 29.62290131, 108.76770535 29.62301193, 108.76739826 29.62303864, 108.76719608 29.62289559, 108.76696720 29.62275826, 108.76652470 29.62245880, 108.76614895 29.62244927, 108.76578083 29.62244354, 108.76562443 29.62244927, 108.76530142 29.62249891, 108.76505537 29.62246076, 108.76441260 29.62235013, 108.76338644 29.62218610, 108.76280832 29.62113893, 108.76216744 29.62020814, 108.76174782 29.61968934, 108.76125191 29.61919343, 108.76061867 29.61870515, 108.75993965 29.61789643, 108.75950477 29.61724030, 108.75919960 29.61653076, 108.75906990 29.61568389, 108.75887153 29.61482940, 108.75865791 29.61414275, 108.75839088 29.61344847, 108.75813911 29.61306700, 108.75796363 29.61257872, 108.75778815 29.61208280, 108.75745246 29.61154875, 108.75697943 29.61106809, 108.75599524 29.61059507, 108.75492712 29.61016019, 108.75404973 29.60983975, 108.75317998 29.60945828, 108.75231023 29.60895474, 108.75153202 29.60839779, 108.75098271 29.60787136, 108.75054020 29.60724575, 108.75036472 29.60680324, 108.75025791 29.60630733, 108.75009006 29.60530787, 108.75002140 29.60429316, 108.75003666 29.60317926, 108.75015110 29.60256891, 108.75037998 29.60193567, 108.75122685 29.60096673, 108.75197453 29.60018853, 108.75278325 29.59946373, 108.75372930 29.59873131, 108.75447698 29.59824303, 108.75527044 29.59787681, 108.75602576 29.59770134, 108.75720832 29.59784630, 108.75823066 29.59805992, 108.75918434 29.59833458, 108.76042030 29.59873131, 108.76164864 29.59912804, 108.76282364 29.59944657, 108.76344544 29.59963158, 108.76396042 29.59974602, 108.76441246 29.59981087, 108.76486450 29.59983758, 108.76582581 29.59978989, 108.76621109 29.59979943, 108.76659066 29.59984139, 108.76696641 29.59991387, 108.76732880 29.60002259, 108.76765877 29.60013322, 108.76798684 29.60027055, 108.76859147 29.60053758, 108.76920754 29.60079698, 108.76983506 29.60102204, 108.77043397 29.60126046, 108.77099473 29.60152368, 108.77140672 29.60171250, 108.77183587 29.60188607, 108.77235658 29.60203485, 108.77282197 29.60210542, 108.77329881 29.60212449, 108.77377756 29.60211686, 108.77470644 29.60210733, 108.77554186 29.60207681, 108.77637919 29.60204438, 108.77720316 29.60199288, 108.77802523 29.60192231, 108.77872714 29.60183839, 108.77943667 29.60172395, 108.78014048 29.60155610, 108.78084048 29.60140161, 108.78185901 29.60119752, 108.78241977 29.60107545, 108.78293094 29.60094384, 108.78333148 29.60081986, 108.78372821 29.60067300, 108.78415546 29.60048417, 108.78455028 29.60026864, 108.78481540 29.60009698, 108.78507480 29.59989480, 108.78560504 29.59950379, 108.78613338 29.59914712, 108.78667316 29.59880570, 108.78716144 29.59849480, 108.78763637 29.59820298, 108.78808651 29.59789399, 108.78850422 29.59756592))
```
### 截取函数
```mysql
create definer=`root`@`%` function `bingo`.`f_split_pos`(
`s` blob, 
`split` varchar(10), 
`pos` int) returns varchar(200) charset utf8
begin
    -- 返回结果
    declare rs varchar(200);
    -- 单位长度
    declare dw_length int default 0;
        
    -- 如果开头有分隔符就去掉,因为开头有分隔符会影响运算单位长度
    if s like concat(split,'%')
        then set s = substring(s,length(split)+1,length(s));
    end if;
        
    -- 直接从需要的位置-1(pos-1)+1,也就是当前pos的起始位置,然后截取单位长度-分隔符长度.
    set dw_length = instr(s,split) + length(split)-1;
    set rs = substring(s,dw_length*(pos-1)+1,dw_length-length(split));
    
    return ifnull(rs,'-1');
end;
```
### 存储过程实现
```mysql
call p_shape();
create definer=`root`@`%` procedure `bingo`.`p_shape`()
begin
    -- 外层循环表行数
    declare count_lines int;
    -- 内层循环点个数
    declare point_number int;

    -- 当前shape,用于返回
    declare shape_now blob;
    -- 掐头去尾的shape,用于取出点
    declare string blob;
    
    -- 取出来的点
    declare points varchar(50);
    
    -- 外层循环
    select count(1) into count_lines from dim_jy_zrq;
    repeat 
    set count_lines = count_lines - 1;
    select shape,replace(replace(replace(shape,'polygon  (( ',''),')',''),'multipolygon  ((( ','') into shape_now,string from dim_jy_zrq limit count_lines,1;
        
        -- 内层循环
        set point_number = length(string) - length(replace(string,',','')) + 1;
        drop temporary table if exists temp;
        create temporary table if not exists temp (lng varchar(30),lat varchar(30));
        repeat 
        set point_number = point_number - 1;
        set points = f_split_pos(string,', ',point_number);
        insert into temp value (f_split_pos(points,' ',1),f_split_pos(points,' ',2));
    
        until point_number = 0
        end repeat;

    -- 内层点循环完成以后取出最值到结果表
    insert into dim_jy_zrq_result 
    select shape_now,max(lng),min(lng),max(lat),min(lat) from temp where lng <> '-1';

    until count_lines = 0
    end repeat;

    select count_lines;
end;
```
### 函数实现
```mysql
insert into dim_jy_zrq_result
select 
    shape,
    f_shape_max_lng(shape) as max_lng,
    f_shape_min_lng(shape) as min_lng,
    f_shape_max_lat(shape) as max_lat,
    f_shape_min_lat(shape) as min_lat
from dim_jy_zrq;

create definer=`root`@`%` function `bingo`.`f_shape_max_lng`(
var blob) returns varchar(100) charset utf8
begin 
    -- 最值
    declare max_lng varchar(30) default 0;
    -- shape字段中点的个数
    declare point_number int unsigned default 0;
    -- 点
    declare points varchar(50) default 0;

    -- 去掉头尾 
    declare string blob;
    select replace(replace(replace(var,'polygon  (( ',''),')',''),'multipolygon  ((( ','') into string;

    -- 判断有多少个逗号,即多少个点
    set point_number = length(string) - length(replace(string,',','')) + 1;

    -- 把这些点切出来放进临时表
    drop temporary table if exists temp;
    create temporary table if not exists temp (lng varchar(30),lat varchar(30));
    repeat 
    set points = f_split_pos(string,', ',point_number);
    insert into temp value (f_split_pos(points,' ',1),f_split_pos(points,' ',2));
    set point_number = point_number - 1;
    until point_number = 0
    end repeat;

    -- 删除为-1的脏数据
    delete from temp where lng = '-1';

    -- 循环临时表,去除最值,返回
    select max(lng) into max_lng from temp;

    return max_lng;
end;

create definer=`root`@`%` function `bingo`.`f_shape_min_lng`(
var blob) returns varchar(100) charset utf8
begin 
    -- 比较后取最值
    declare min_lng varchar(30) default 0;
    -- shape字段中点的个数
    declare point_number int unsigned default 0;
    -- 点
    declare points varchar(50) default 0;

    -- 去掉头尾 
    declare string blob;
    select replace(replace(replace(var,'polygon  (( ',''),')',''),'multipolygon  ((( ','') into string;

    -- 判断有多少个逗号,即多少个点
    set point_number = length(string) - length(replace(string,',','')) + 1;

    -- 把这些点切出来放进临时表
    drop temporary table if exists temp;
    create temporary table if not exists temp (lng varchar(30),lat varchar(30));
    repeat 
    set points = f_split_pos(string,', ',point_number);
    insert into temp value (f_split_pos(points,' ',1),f_split_pos(points,' ',2));
    set point_number = point_number - 1;
    until point_number = 0
    end repeat;

    -- 删除为-1的脏数据
    delete from temp where lng = '-1';

    -- 循环临时表,去除最值,返回
    select min(lng) into min_lng from temp;

    return min_lng;
end;

create definer=`root`@`%` function `bingo`.`f_shape_max_lat`(
var blob) returns varchar(100) charset utf8
begin 
    -- 比较后取最值
    declare max_lat varchar(30) default 0;
    -- shape字段中点的个数
    declare point_number int unsigned default 0;
    -- 点
    declare points varchar(50) default 0;

    -- 去掉头尾 
    declare string blob;
    select replace(replace(replace(var,'polygon  (( ',''),')',''),'multipolygon  ((( ','') into string;

    -- 判断有多少个逗号,即多少个点
    set point_number = length(string) - length(replace(string,',','')) + 1;

    -- 把这些点切出来放进临时表
    drop temporary table if exists temp;
    create temporary table if not exists temp (lng varchar(30),lat varchar(30));
    repeat 
    set points = f_split_pos(string,', ',point_number);
    insert into temp value (f_split_pos(points,' ',1),f_split_pos(points,' ',2));
    set point_number = point_number - 1;
    until point_number = 0
    end repeat;

    -- 删除为-1的脏数据
    delete from temp where lng = '-1';

    -- 循环临时表,去除最值,返回
    select max(lat) into max_lat from temp;

    return max_lat;
end;

create definer=`root`@`%` function `bingo`.`f_shape_min_lat`(
var blob) returns varchar(100) charset utf8
begin 
    -- 比较后取最值
    declare min_lat varchar(30) default 0;
    -- shape字段中点的个数
    declare point_number int unsigned default 0;
    -- 点
    declare points varchar(50) default 0;

    -- 去掉头尾 
    declare string blob;
    select replace(replace(replace(var,'polygon  (( ',''),')',''),'multipolygon  ((( ','') into string;

    -- 判断有多少个逗号,即多少个点
    set point_number = length(string) - length(replace(string,',','')) + 1;
    
    -- 把这些点切出来放进临时表
    drop temporary table if exists temp;
    create temporary table if not exists temp (lng varchar(30),lat varchar(30));
    repeat 
    set points = f_split_pos(string,', ',point_number);
    insert into temp value (f_split_pos(points,' ',1),f_split_pos(points,' ',2));
    set point_number = point_number - 1;
    until point_number = 0
    end repeat;

    -- 删除为-1的脏数据
    delete from temp where lng = '-1';

    -- 循环临时表,去除最值,返回
    select min(lat) into min_lat from temp;

    return min_lat;
end;
```
